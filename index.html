<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChessWeb</title>

    <!-- Tải jQuery (cần cho chessboard.js) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    
    <!-- Tải thư viện logic cờ (chess.js) để xử lý PGN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"
        integrity="sha512-xRllwz2gdZciIB+AkEbeq+gVhX8VB8XsfqeFbUh+SzHlN96dEduwtTuVuc2u9EROlmW9+yhRlxjif66ORpsgVA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Tải thư viện Socket.IO (để nói chuyện với Backend) -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>

    <!-- Tải thư viện CSS của chessboard.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.css" />
    
    <!-- Tải file CSS của bạn -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1 class="title">Chess Game</h1>

    <!-- Trạng thái kết nối -->
    <div id="status">Đang kết nối...</div>

    <div class="display-f">
        <!-- Cột bên trái: Bàn cờ + Nút bấm + Admin -->
        <div class="board-controls-container">
            <!-- Board (Tự động scale) -->
            <div id="myBoard"></div>
            
            <!-- NÚT BẤM ĐIỀU KHIỂN (Review) -->
            <div class="controls">
                <button id="btnStart" title="First Move"><<</button>
                <button id="btnBack" title="Previous Move"><</button>
                <button id="btnNext" title="Next Move">></button>
                <button id="btnEnd" title="Last Move (Live)">>></button>
            </div>

            <!-- BẢNG ADMIN (Đã di chuyển) -->
            <div id="adminPanel" style="display: none;">
                <h3>Bảng Sửa lỗi Admin</h3>
                <input type="password" id="adminPassword" placeholder="Mật khẩu" />
                <textarea id="adminPgnInput" placeholder="Dán PGN chính xác vào đây..."></textarea>
                <button id="adminSendBtn" class="admin-button-fix">Gửi PGN Sửa lỗi</button>
                <button id="adminResetBtn" class="admin-button-reset">Reset Game (Bắt đầu ván mới)</button>
            </div>
        </div>

        <!-- Cột bên phải: PGN (Layout Lichess) -->
        <div class="pgn-container">
            
            <!-- Tiêu đề PGN -->
            <div class="pgn-header">
                <h2>PGN</h2>
            </div>

            <!-- (PHẦN 1) Vùng cuộn PGN (Move List) -->
            <div class="move-inner-content">
                <div class="move-list" id="move-list-container"></div>
            </div>

            <!-- (PHẦN 2) VÙNG PGN STRING (Giống Lichess) -->
            <div class="pgn-string-container">
                <textarea id="fullPgnString" readonly placeholder="Toàn bộ PGN sẽ hiện ở đây..."></textarea>
                <button id="copyPgnBtn" title="Copy toàn bộ PGN">
                    <!-- Icon SVG copy -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    Copy PGN
                </button>
            </div>
        </div>
    </div>

    <!-- Template PGN (dùng để copy khi có nước đi mới) -->
    <template id="pgn-template">
        <div class="pgn-row">
            <span class="move-number"></span>
            <span class="white-move" data-move-index=""></span>
            <span class="black-move" data-move-index=""></span>
        </div>
    </template>

    <!-- Tải thư viện JS của chessboard.js (PHẢI NẰM SAU CÙNG) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.js"></script>
    
    <!-- Tải file JavaScript của bạn -->
    <script src="script.js"></script>
</body>
</html>